<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <title>بدء دفع الراجحي</title>
  <meta name="referrer" content="no-referrer">
</head>
<body>
  <p>جارٍ تجهيز التحويل لبوابة الراجحي…</p>

  <!-- لمسار Servlet: tranportalId / tranportalPassword -->
  <form id="payForm" method="post" action="{{ gateway_url }}">
    <input type="hidden" name="tranportalId" value="{{ id }}">
    <input type="hidden" name="tranportalPassword" value="{{ password }}">
    <input type="hidden" name="trandata" value="{{ trandata }}">

    <!-- أيضاً نرسل الروابط كحقول POST علوية (خارج trandata) بحروف كبيرة -->
    <input type="hidden" name="ResponseURL" value="{{ response_url }}">
    <input type="hidden" name="ErrorURL" value="{{ error_url }}">
  </form>

  {% if debug %}
    <pre style="white-space:pre-wrap;direction:ltr">
gateway={{ gateway_url }}
tranportalId={{ id }}
tranportalPassword=********
trandata_len={{ trandata|length }}
ResponseURL={{ response_url }}
ErrorURL={{ error_url }}
{{ debug_plain|safe }}
    </pre>
    <button onclick="document.getElementById('payForm').submit()">إرسال يدويًا الآن</button>
  {% else %}
    <script>document.getElementById('payForm').submit();</script>
  {% endif %}
</body>
</html>
