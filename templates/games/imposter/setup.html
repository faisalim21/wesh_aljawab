<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ø¥Ø¹Ø¯Ø§Ø¯ Ù„Ø¹Ø¨Ø© Ø§Ù…Ø¨ÙˆØ³ØªØ± - ÙˆØ´ Ø§Ù„Ø¬ÙˆØ§Ø¨</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;600;800;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --primary:#6366f1;
      --secondary:#06b6d4;
      --success:#22c55e;
      --bg:#f8fafc;
      --card:#ffffff;
      --text:#0f172a;
      --muted:#64748b;
      --border:#e5e7eb;
      --grad:linear-gradient(135deg,#6366f1,#8b5cf6,#06b6d4);
    }

    body{
      background:
        radial-gradient(circle at top right,rgba(99,102,241,.08),transparent 45%),
        radial-gradient(circle at top left,rgba(6,182,212,.08),transparent 45%),
        var(--bg);
      font-family:"Tajawal",sans-serif;
      color:var(--text);
      min-height:100vh;
    }

    /* ===== Layout ===== */
    .setup-wrapper{
      max-width:520px;
      margin:120px auto 90px;
      padding:0 18px;
    }

    .setup-card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:28px;
      padding:36px 32px 40px;
      box-shadow:0 18px 45px rgba(15,23,42,.12);
      animation:fadeIn .5s ease;
    }

    @keyframes fadeIn{
      from{opacity:0;transform:translateY(16px)}
      to{opacity:1;transform:translateY(0)}
    }

    .setup-title{
      text-align:center;
      font-size:2.1rem;
      font-weight:900;
      margin-bottom:6px;
      background:var(--grad);
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
    }

    .setup-sub{
      text-align:center;
      color:var(--muted);
      font-size:1rem;
      margin-bottom:28px;
    }

    /* ===== Form ===== */
    label{
      font-weight:800;
      margin-bottom:6px;
      margin-top:18px;
      display:block;
      color:var(--text);
    }

    .form-control{
      background:#ffffff;
      border:1px solid var(--border);
      color:var(--text);
      border-radius:16px;
      padding:13px 14px;
      font-size:1.05rem;
    }

    .form-control:focus{
      background:#ffffff;
      color:var(--text);
      border-color:#6366f1;
      box-shadow:0 0 0 .2rem rgba(99,102,241,.18);
    }

    .hint{
      font-size:.85rem;
      color:var(--muted);
      margin-top:6px;
    }

    /* ===== Button ===== */
    .btn-start{
      margin-top:34px;
      width:100%;
      padding:15px;
      border-radius:18px;
      border:none;
      font-size:1.25rem;
      font-weight:900;
      color:#fff;
      background:var(--grad);
      box-shadow:0 16px 36px rgba(99,102,241,.4);
      transition:.25s ease;
    }

    .btn-start:hover{
      transform:translateY(-2px);
      box-shadow:0 22px 50px rgba(99,102,241,.55);
    }

    @media(max-width:480px){
      .setup-title{font-size:1.8rem}
    }
  </style>
</head>

<body>
{% include "header.html" %}

<div class="setup-wrapper">
  <div class="setup-card">

    <div class="setup-title">ğŸ­ Ø¥Ø¹Ø¯Ø§Ø¯ Ù„Ø¹Ø¨Ø© Ø§Ù…Ø¨ÙˆØ³ØªØ±</div>
    <div class="setup-sub">
      Ø§Ø®ØªØ± Ø¹Ø¯Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† ÙˆØ§Ù„Ø¥Ù…Ø¨ÙˆØ³ØªØ± Ø«Ù… Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¬ÙˆÙ„Ø©
    </div>

    <form method="POST" action="{% url 'games:imposter_setup' package.id %}">
      {% csrf_token %}

      <label>Ø¹Ø¯Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†</label>
      <input
        type="number"
        name="players_count"
        class="form-control"
        min="3"
        max="20"
        value="4"
        required
      >
      <div class="hint">ÙŠØ¬Ø¨ Ø£Ù„Ø§ ÙŠÙ‚Ù„ Ø§Ù„Ø¹Ø¯Ø¯ Ø¹Ù† 3 Ù„Ø§Ø¹Ø¨ÙŠÙ†</div>

      <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ù…Ø¨ÙˆØ³ØªØ±</label>
      <input
        type="number"
        name="imposters_count"
        class="form-control"
        min="1"
        max="15"
        value="1"
        required
      >
      <div class="hint">Ø­Ø¯Ø¯ Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ù…Ø¨ÙˆØ³ØªØ± ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø¬ÙˆÙ„Ø©</div>

      <button
            type="submit"
            class="btn-start"
            onclick="openGameInNewTab(event)"
            >
            ğŸš€ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø©
        </button>

    </form>

  </div>
</div>
<script>
  function openGameInNewTab(e) {
    e.preventDefault();

    const form = e.target.closest("form");
    const actionUrl = form.action;

    // Ù…Ø­Ø§ÙˆÙ„Ø© ÙØªØ­ ØªØ¨ÙˆÙŠØ¨ Ø¬Ø¯ÙŠØ¯ (Ù…Ø¶Ù…ÙˆÙ†Ø© Ù„Ø£Ù†Ù‡Ø§ Ø¯Ø§Ø®Ù„ click)
    const newTab = window.open(actionUrl, "_blank");

    if (newTab) {
      // Ø£Ø±Ø³Ù„ Ø§Ù„ÙÙˆØ±Ù… Ù„Ù„ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯
      const clonedForm = form.cloneNode(true);
      clonedForm.target = "_self";
      newTab.document.body.appendChild(clonedForm);
      clonedForm.submit();
    } else {
      // fallback 100% â€” Ù„Ùˆ Ø§Ù„Ù…ØªØµÙØ­ Ù…Ù†Ø¹ Ø§Ù„ØªØ¨ÙˆÙŠØ¨
      form.submit();
    }
  }
</script>

{% include "footer.html" %}
</body>
</html>
